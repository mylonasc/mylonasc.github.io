---
layout: post
title: Bayesian Graph Networks and Crack Localization
subtitle: 
bigimg: /img/authorgraph.png
tags: [Graph Neural Networks, Bayesian Deep Learning, Local reparametrization, Crack Detection, PhD]
---

# Context
In Structural Health Monitoring (SHM), we want to automatically detect defects/damages on a structure in order to perform interventions.
Usually the focus of SHM is the detection of changes in the modal characteristics of structures. However, in order for a damage to influence
the modal characteristics of a structure, it has to be quite significant. On the other hand, local strain concentrations occur even for the slightest defect or inhomogeneity under certain loading conditions.

Although this approach is promising, there are certain limitations:

* Certain loading conditions (and sensor positions/orientations) cannot be used to localize a crack (we have **ambiguity/uncertainty** on localization)
* it is not easy to consistently reason about the spatial variations of strain tensors w.r.t. defect positions, so [hand-engineering features for localization is hard](https://www.research-collection.ethz.ch/bitstream/handle/20.500.11850/315815/1/Spatio_temporal_crack_detection.pdf), therefore we want a fully **data-driven** method 
* assuming we have **discrete sensors**, it is not clear how to learn a function that can **jointly** take into account the stress-tensor time-series at arbitrary positions by exploiting the **relative positioning** of the sensors to learn spatial patterns.

In order to deal with the arbitrary positioning of sensors, I define a set of learnable functions (deep neural networks) that parametrize their relations and at the same time allow for exchange of information between neighboring sensors. This is where Graph Neural Networks (GraphNets) come into play. GraphNets implement learnable message passing on static graphs that implement *inductive biases*. The inductive biases in this work are the following:

1. effect of strain is spatially local
2. Information from neighboring sensors can be used detect spatial crack related patterns on a strain-field
3. The relative positions of the sensors are important (also for correctly taking into account correctly the strain tensor readings which vary with sensor orientation)

Here is a simulation of the strain patterns around a crack:
![strainanim](/img/strainanim.gif)

## Dealing with Uncertainty
The strain-based crack localization problem is in general ill-posed (as most inverse problems).
One of the reasons this problem is ill-posed, is because there are strain patterns that can correspond to different defects (even for a single crack).
Moreover, when learning on real data, there is inevitable noise in the measurements which will not allow for complete determination of the functions that transform the strain readings to crack positions. 

In order to deal with this issue, weight uncertainty on the learned GraphNet functions was used. The [additive local reparametrization trick](https://www.tensorflow.org/probability/api_docs/python/tfp/layers/DenseLocalReparameterization) for variational Bayes was used. The following figure summarizes the approximations used:

![locrep](/img/bnnlocrep.png)

Essentially, you can think about this as a VAE-type reparametrization of the activations of a layer (and a related modification to the loss). 
I highly recommend [this lecture](https://youtu.be/DFdqafS4iN4?t=1126) on the subject if you would like to learn more.
In [my conference paper](https://arxiv.org/pdf/2012.06791.pdf) the implementation of *Bayesian Graph Networks* is demonstrated on a simulated dataset.

## GNN implementation:
I have been developing my own hackable GNN library to be able to implement my own ideas faster without the constraints of [deepmind's](https://github.com/deepmind/graph_nets) or [microsoft's](https://github.com/microsoft/tf2-gnn) existing libraries. If you're interested have a look at my repository [mylonasc/tf-gnns](https://github.com/mylonasc/tf_gnns). 

## Presentation video
<iframe width="560" height="315" src="https://www.youtube.com/embed/_2UqsidmosY" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
